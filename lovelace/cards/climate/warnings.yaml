type: custom:auto-entities
card:
  type: entities
  title: Braybrook Weather Warnings
  show_header_toggle: false
  card_mod:
    style: |
      ha-card {
        background: linear-gradient(145deg, #1E3A5F 0%, #0D1B2A 100%);
        color: white;
        border-radius: 12px;
        box-shadow: 0 8px 16px rgba(30, 58, 95, 0.4);
        border: none;
        transition: all 0.3s ease;
      }
      ha-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 24px rgba(30, 58, 95, 0.5);
      }
      .card-header {
        color: white;
      }
      .entity-name, .entity-state, .secondary {
        color: white !important;
      }
filter:
  template: >
    {% set warnings = state_attr('sensor.braybrook_warnings', 'warnings') %}
    {% if warnings %}
      {% set relevant_warnings = warnings | selectattr('title', 'defined') | rejectattr('title', 'search', 'sheep|marine|coastal|grazier', ignorecase=True) | list %}
      {% if relevant_warnings %}
      [
      {% for w in relevant_warnings %}
        {
          "entity": "sensor.braybrook_warnings",
          "type": "custom:template-entity-row",
          "icon": "mdi:alert",
          "name": "{{ w.title }}",
          "class": "{{ 'major' if w.warning_group_type == 'major' else 'minor' }}",
          "state": "{{ w.phase | capitalize }}",
          "secondary": "Iss: {{ w.issue_time }} | Exp: {{ w.expiry_time }}"
        }
        {% if not loop.last %},{% endif %}
      {% endfor %}
      ]
      {% else %}
      []
      {% endif %}
    {% else %}
    []
    {% endif %}
