---
# ============================================================================
# MOTION DETECTION AUTOMATION
# ============================================================================
# Purpose: Alert on outside motion during night hours
# Documentation: docs/setup/MOTION_FACE_DETECTION_SETUP.md
# ============================================================================

- id: front_door_camera_motion_detection
  alias: Front Door Camera - Motion Detection
  description: Sends notification and displays camera when Blue Iris detects motion
    at front door
  triggers:
  - trigger: state
    entity_id: binary_sensor.blue_iris_cam_front_door
    to: 'on'
  conditions:
  - condition: state
    entity_id: input_select.occupancy
    state:
    - Home
    - Sleeping
  actions:
  - action: notify.mobile_app_samsung_galaxy_s22_ultra
    data:
      title: Front Door Motion Detected
      message: "{{ states('sensor.bi_front_door_memo') }}"
      data:
        image: /api/camera_proxy/camera.bi_front_door_camera
        clickAction: /lovelace/security
        tag: front_door_motion
        ttl: 0
        priority: high
  mode: single
- id: driveway_camera_motion_detection
  alias: Driveway Camera - Motion Detection
  description: Sends notification when Blue Iris detects motion in the driveway
  triggers:
  - trigger: state
    entity_id: binary_sensor.blue_iris_cam_driveway
    to: 'on'
  conditions:
  - condition: state
    entity_id: input_select.occupancy
    state:
    - Home
    - Sleeping
  actions:
  - action: notify.mobile_app_samsung_galaxy_s22_ultra
    data:
      title: Driveway Motion Detected
      message: "{{ states('sensor.bi_driveway_memo') }}"
      data:
        image: /api/camera_proxy/camera.driveway_cam_fluent
        clickAction: /lovelace/security
        tag: driveway_motion
        ttl: 0
        priority: high
  mode: single
- id: motion_detection_outside
  alias: "Security - Outside Motion Detection"
  description: "Alert on outside motion during night hours (8 PM - 6 AM)"

  trigger:
    - platform: state
      entity_id: binary_sensor.frigate_person_detected
      to: "on"
      for:
        seconds: 2

  condition:
    # Night mode (8 PM - 6 AM)
    - condition: or
      conditions:
        - condition: time
          after: "20:00:00"
        - condition: time
          before: "06:00:00"

  action:
    - service: notify.persistent_notification
      data:
        title: "Motion Detected"
        message: "Outside motion detected at {{ now().strftime('%I:%M %p') }}"

  mode: single
