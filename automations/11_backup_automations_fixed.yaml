---
# ============================================================================
# Backup Automations - Fixed Versions
# ============================================================================
# These automations replace the broken UI-created versions that used
# invalid services (backup.create and shell_command.backup_to_nas)
# ============================================================================

# System - Daily Backup (3 AM) - FIXED VERSION
# Replaces automation.system_daily_backup_3_am which used invalid backup.create
- id: 'system_daily_backup_3_am'
  alias: "System - Daily Backup (3 AM)"
  description: "Create automated backup at 3:00 AM daily with notifications"

  trigger:
    - platform: time
      at: "03:00:00"

  condition: []

  action:
    # CORRECT SERVICE: Use hassio.backup_full (works on all HA versions)
    # DO NOT USE: backup.create (causes "unknown action" error)
    - service: hassio.backup_full
      data:
        name: "Auto Backup {{ now().strftime('%Y-%m-%d %H:%M') }}"

    - delay:
        seconds: 10

    - service: notify.persistent_notification
      data:
        title: "Backup Completed"
        message: "Daily backup created successfully at {{ now().strftime('%I:%M %p') }}"

  mode: single
