---
- id: '1665308479762'
  alias: Living Room - Preheat at 5 30 AM if Cold
  description: Starts the living room climate at 05:30 when temperatures are low,
    provided manual overrides are off and someone is home.
  triggers:
  - at: 05:30:00
    trigger: time
  conditions:
  - condition: or
    conditions:
    - condition: numeric_state
      entity_id: sensor.ble_temperature_kitchen_temp_humidity_sensor
      below: 19
    - condition: numeric_state
      entity_id: sensor.living_room_temperature_offset
      below: 17.5
  - condition: state
    entity_id: input_boolean.super_hot_today
    state: 'off'
  - condition: state
    entity_id: binary_sensor.someone_home
    state: 'on'
    alias: Someone Home
  - condition: state
    entity_id: input_boolean.climate_manual_control_living
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_living_room_should_be_on
    state: 'on'
    alias: Living Room HVAC Master On
  actions:
  - data:
      preset_mode: comfort
    action: climate.set_preset_mode
    target:
      entity_id: climate.living_room_versatile_thermostat
  - action: climate.set_hvac_mode
    data:
      hvac_mode: heat
    target:
      entity_id: climate.living_room_versatile_thermostat
  mode: single
- id: '1746997822978'
  alias: Living Room - Turn Off Heater When Warm
  description: Shuts off the living room heater once the room reaches the comfort
    temperature.
  triggers:
  - trigger: time
    at: 06:30:00
  - trigger: time
    at: 07:00:00
  - trigger: time
    at: 07:30:00
  - trigger: time
    at: 06:00:00
  conditions:
  - condition: state
    entity_id: climate.living_room_versatile_thermostat
    state: heat
    for:
      hours: 0
      minutes: 30
      seconds: 0
  - condition: or
    conditions:
    - condition: numeric_state
      entity_id: sensor.living_room_temperature_offset
      above: 20
    - condition: numeric_state
      entity_id: sensor.ble_temperature_kitchen_temp_humidity_sensor
      above: 20
  - condition: state
    entity_id: input_boolean.climate_manual_control_living
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_living_room_should_be_on
    state: 'on'
    alias: Living Room HVAC Master On
  actions:
  - action: climate.set_hvac_mode
    target:
      entity_id: climate.living_room_versatile_thermostat
    data:
      hvac_mode: 'off'
  mode: single
- id: '1752139587383'
  alias: Living Room - Heater Off Overnight
  description: Turns the living room heater off each night as part of the bedtime
    routine.
  triggers:
  - trigger: numeric_state
    entity_id: sensor.samsung_galaxy_s22_ultra_sleep_confidence
    below: 80
  - trigger: numeric_state
    entity_id: sensor.slvdh_floors_descended
    above: 1
  conditions:
  - condition: state
    entity_id: binary_sensor.someone_home
    state: 'on'
    alias: Someone Home
  - condition: time
    after: '20:30:00'
    before: 01:00:00
  - condition: state
    entity_id: input_boolean.climate_manual_control_living
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_living_room_should_be_on
    state: 'on'
    alias: Living Room HVAC Master On
  actions:
  - metadata: {}
    data:
      hvac_mode: 'off'
    action: climate.set_hvac_mode
    target:
      area_id: living_room
  mode: single
- id: '1747862856741'
  alias: Living Room - Night Temperature Setback
  description: Applies an overnight setback to the living room thermostat for energy
    savings. Winter automation
  triggers:
  - entity_id:
    - sensor.living_room_temperature_offset
    for:
      hours: 0
      minutes: 10
      seconds: 0
    above: 16
    id: Hot
    trigger: numeric_state
  - entity_id:
    - sensor.living_room_temperature_offset
    for:
      hours: 0
      minutes: 10
      seconds: 0
    below: 14.5
    id: Cold
    trigger: numeric_state
  conditions:
  - condition: time
    after: '22:00:00'
    before: 05:00:00
    weekday:
    - sun
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: state
    entity_id: input_boolean.climate_manual_control_living
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_living_room_should_be_on
    state: 'on'
    alias: Living Room HVAC Master On
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Hot
      sequence:
      - metadata: {}
        data:
          hvac_mode: 'off'
        action: climate.set_hvac_mode
        target:
          entity_id: climate.living_room_versatile_thermostat
    - conditions:
      - condition: trigger
        id:
        - Cold
      sequence:
      - metadata: {}
        data:
          preset_mode: eco
        action: climate.set_preset_mode
        target:
          entity_id: climate.living_room_versatile_thermostat
      - metadata: {}
        data:
          hvac_mode: heat
        action: climate.set_hvac_mode
        target:
          entity_id:
          - climate.living_room_versatile_thermostat
  mode: single
- id: '1714337117111'
  alias: Master Bedroom - Turn Off AC on Wake
  description: Shuts down the master bedroom climate equipment when wake-up sensors
    fire.
  triggers:
  - trigger: numeric_state
    entity_id: sensor.samsung_galaxy_s22_ultra_sleep_confidence
    below: 80
  - trigger: numeric_state
    entity_id: sensor.slvdh_floors_descended
    above: 1
  conditions:
  - condition: state
    entity_id: binary_sensor.someone_home
    state: 'on'
    alias: Someone Home
  - condition: time
    after: 06:00:00
    before: 09:00:00
  - condition: state
    entity_id: input_boolean.climate_manual_control_master
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_master_bedroom_should_be_on
    state: 'on'
    alias: Master Bedroom HVAC Master On
  actions:
  - metadata: {}
    data:
      hvac_mode: 'off'
    action: climate.set_hvac_mode
    target:
      area_id: master_bedroom
  - metadata: {}
    data: {}
    action: fan.turn_off
    target:
      area_id: master_bedroom
  mode: single
- id: '1699526539731'
  alias: Master Bedroom - Fan On When AC Starts
  description: Adjusts the master bedroom fan when the climate shifts between cooling
    and heating.
  triggers:
  - trigger: state
    entity_id: climate.masterbed_versatile_thermostat
    to: cool
    id: Cool
  - trigger: state
    entity_id: climate.masterbed_versatile_thermostat
    to: heat
    id: Heat
  conditions:
  - condition: state
    entity_id: input_boolean.hvac_master_bedroom_should_be_on
    state: 'on'
    alias: Master Bedroom HVAC Master On
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: Cool
      - condition: state
        entity_id: fan.masterbedroom_fan
        state: 'off'
      sequence:
      - service: fan.set_percentage
        data:
          percentage: 33
        target:
          entity_id: fan.masterbedroom_fan
    - conditions:
      - condition: trigger
        id: Heat
      sequence:
      - service: fan.turn_off
        target:
          entity_id: fan.masterbedroom_fan
  mode: single
- id: '1747602740393'
  alias: Master Bedroom - Daytime Comfort Heating
  description: Maintains comfort temperature in the master bedroom during working-from-home
    hours (08:00-18:00). Activates heating when temperature drops below 18Â°C and you're WFH.
  triggers:
  - trigger: numeric_state
    entity_id: sensor.ble_temperature_masterbed_temp_humidity_sensor
    below: 18
    for:
      minutes: 0
    id: Cold
  - trigger: numeric_state
    entity_id: sensor.ble_temperature_masterbed_temp_humidity_sensor
    above: 20
    id: Warm
  - trigger: time
    at: '08:00:00'
    id: Daytime Start
  - trigger: time
    at: '18:00:00'
    id: Daytime End
  - trigger: state
    entity_id: input_boolean.climate_manual_control_master
    to: 'off'
    id: Manual Control Off
  conditions:
  - condition: or
    conditions:
    # Allow Warm and Daytime End triggers to always proceed (turn off heating)
    - condition: trigger
      id:
      - Warm
      - Daytime End
    # For heating triggers, require time window and WFH
    - condition: and
      conditions:
      - condition: time
        after: '08:00:00'
        before: '18:00:00'
      - condition: state
        entity_id: binary_sensor.working_from_home
        state: 'on'
        alias: Working From Home
  - condition: state
    entity_id: input_boolean.climate_manual_control_master
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_master_bedroom_should_be_on
    state: 'on'
    alias: Master Bedroom HVAC Master On
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Cold
        - Daytime Start
        - Manual Control Off
      - condition: numeric_state
        entity_id: sensor.ble_temperature_masterbed_temp_humidity_sensor
        below: 18
      sequence:
      - action: climate.set_preset_mode
        target:
          entity_id: climate.masterbed_versatile_thermostat
        data:
          preset_mode: comfort
      - action: climate.set_hvac_mode
        target:
          entity_id: climate.masterbed_versatile_thermostat
        data:
          hvac_mode: heat
    - conditions:
      - condition: trigger
        id:
        - Warm
        - Daytime End
      sequence:
      - action: climate.set_hvac_mode
        target:
          entity_id: climate.masterbed_versatile_thermostat
        data:
          hvac_mode: 'off'
  mode: single
- id: '1747602740394'
  alias: Master Bedroom - Heater Night Assist
  description: Turns on the master bedroom heater overnight when temperatures fall
    below the threshold. Winter automation
  triggers:
  - entity_id:
    - sensor.temperaturesensor_temperature
    for:
      hours: 0
      minutes: 0
      seconds: 0
    above: 17.2
    id: Hot
    trigger: numeric_state
  - entity_id:
    - sensor.temperaturesensor_temperature
    for:
      hours: 0
      minutes: 10
      seconds: 0
    below: 16
    id: Cold
    trigger: numeric_state
  conditions:
  - condition: time
    after: '18:00:00'
    before: 06:00:00
    weekday:
    - sun
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: state
    entity_id: input_boolean.climate_manual_control_master
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_master_bedroom_should_be_on
    state: 'on'
    alias: Master Bedroom HVAC Master On
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Hot
      sequence:
      - metadata: {}
        data:
          preset_mode: none
        target:
          entity_id: climate.masterbed_versatile_thermostat
        enabled: true
        action: climate.set_preset_mode
      - metadata: {}
        data:
          hvac_mode: 'off'
        action: climate.set_hvac_mode
        target:
          entity_id: climate.masterbed_versatile_thermostat
    - conditions:
      - condition: trigger
        id:
        - Cold
      sequence:
      - metadata: {}
        data:
          preset_mode: eco
        action: climate.set_preset_mode
        target:
          entity_id: climate.masterbed_versatile_thermostat
      - metadata: {}
        data:
          hvac_mode: heat
        action: climate.set_hvac_mode
        target:
          entity_id: climate.masterbed_versatile_thermostat
  mode: single
- id: '1747602740395'
  alias: Master Bedroom - Cooling Night Assist
  description: Turns on the master bedroom cooling overnight when temperatures rise
    above the comfortable sleeping threshold. Summer automation to complement heating
    night assist.
  triggers:
  - trigger: time
    at: '21:00:00'
  conditions:
  - condition: state
    entity_id: input_boolean.climate_manual_control_master
    state: 'off'
  - condition: or
    conditions:
    - condition: state
      entity_id: input_select.climate_season
      state: summer
    - condition: state
      entity_id: input_select.climate_season
      state: spring
    - condition: state
      entity_id: input_select.climate_season
      state: autumn
  - condition: state
    entity_id: input_boolean.warm_today_flag
    state: 'on'
  actions:
  - action: input_datetime.set_datetime
    target:
      entity_id: input_datetime.last_trigger_master_bedroom_cooling_night
    data:
      datetime: '{{ now().isoformat() }}'
  - action: input_number.increment
    target:
      entity_id: input_number.master_bedroom_cooling_night_triggers_today
  - metadata: {}
    data:
      preset_mode: boost
    action: climate.set_preset_mode
    target:
      entity_id: climate.masterbed_versatile_thermostat
  - action: climate.set_preset_mode
    metadata: {}
    data:
      preset_mode: boost
    target:
      entity_id: climate.masterbed_versatile_thermostat
  - metadata: {}
    data:
      hvac_mode: cool
    action: climate.set_hvac_mode
    target:
      entity_id: climate.masterbed_versatile_thermostat
  mode: single
- id: '1724061115527'
  alias: Henry's Room - Heater Night Routine
  description: Keeps Henry's room heater running overnight when temperatures drop.
    Winter automation
  triggers:
  - entity_id:
    - sensor.study_esp32_henrysroom_temperature
    for:
      hours: 0
      minutes: 0
      seconds: 0
    above: 20.1
    id: Hot
    trigger: numeric_state
  - entity_id:
    - sensor.study_esp32_henrysroom_temperature
    for:
      hours: 0
      minutes: 0
      seconds: 0
    below: 19.7
    id: Cold
    trigger: numeric_state
  conditions:
  - condition: time
    after: '18:00:00'
    before: 06:00:00
    weekday:
    - sun
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: state
    entity_id: input_boolean.climate_manual_control_study
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_study_should_be_on
    state: 'on'
    alias: Study HVAC Master On
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Hot
      sequence:
      - metadata: {}
        data:
          hvac_mode: 'off'
        action: climate.set_hvac_mode
        target:
          entity_id: climate.henry_s_room_versatile_thermostat
    - conditions:
      - condition: trigger
        id:
        - Cold
      sequence:
      - metadata: {}
        data:
          preset_mode: eco
        action: climate.set_preset_mode
        target:
          entity_id: climate.henry_s_room_versatile_thermostat
      - metadata: {}
        data:
          hvac_mode: heat
        action: climate.set_hvac_mode
        target:
          entity_id: climate.henry_s_room_versatile_thermostat
  mode: single
- id: '1747602506171'
  alias: Otto's Room - Heater Night Routine
  description: Keeps Otto's heater running overnight when the room is cold. Winter
    automation. Uses parameterized thresholds from input_number helpers.
  triggers:
  - entity_id:
    - sensor.ottos_room_temp_humidity_sensor_temperature
    trigger: state
  conditions:
  - condition: time
    after: '18:00:00'
    before: 06:00:00
    weekday:
    - sun
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: state
    entity_id: input_boolean.climate_manual_control_otto
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_kids_room_should_be_on
    state: 'on'
    alias: Kids Room HVAC Master On
  - condition: template
    value_template: '{% set current_temp = states(''sensor.ottos_room_temp_humidity_sensor_temperature'')
      | float(none) %} {% set heating_threshold = states(''input_number.ottos_room_temp_heating'')
      | float(18.5) %} {% set comfort_high = states(''input_number.ottos_room_temp_comfort_high'')
      | float(19.5) %} {{ current_temp is not none and (current_temp < heating_threshold
      or current_temp > comfort_high) }}'
    alias: Temperature outside comfort range
  actions:
  - choose:
    - conditions:
      - condition: template
        value_template: '{% set current_temp = states(''sensor.ottos_room_temp_humidity_sensor_temperature'')
          | float(none) %} {% set comfort_high = states(''input_number.ottos_room_temp_comfort_high'')
          | float(19.5) %} {{ current_temp is not none and current_temp > comfort_high
          }}'
        alias: Room is too hot
      sequence:
      - action: climate.set_preset_mode
        target:
          entity_id: climate.otto_s_room
        data:
          preset_mode: none
      - action: climate.set_hvac_mode
        target:
          entity_id: climate.otto_s_room
        data:
          hvac_mode: 'off'
    - conditions:
      - condition: template
        value_template: '{% set current_temp = states(''sensor.ottos_room_temp_humidity_sensor_temperature'')
          | float(none) %} {% set heating_threshold = states(''input_number.ottos_room_temp_heating'')
          | float(18.5) %} {{ current_temp is not none and current_temp < heating_threshold
          }}'
        alias: Room is too cold
      sequence:
      - action: climate.set_preset_mode
        target:
          entity_id: climate.otto_s_room
        data:
          preset_mode: eco
      - action: climate.set_hvac_mode
        target:
          entity_id: climate.otto_s_room
        data:
          hvac_mode: heat
  mode: single
- id: '1724061115528'
  alias: Henry's Room - Cooling Night Routine
  description: Keeps Henry's room cool overnight when temperatures rise above comfort
    threshold. Summer automation to complement heating night routine. Uses parameterized
    thresholds from input_number helpers.
  triggers:
  - entity_id:
    - sensor.study_esp32_henrysroom_temperature
    trigger: state
  conditions:
  - condition: time
    after: '18:00:00'
    before: 06:00:00
    weekday:
    - sun
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: state
    entity_id: input_boolean.climate_manual_control_study
    state: 'off'
  - condition: state
    entity_id: input_select.climate_season
    state: summer
  - condition: state
    entity_id: input_boolean.hvac_study_should_be_on
    state: 'on'
    alias: Study HVAC Master On
  - condition: template
    value_template: '{% set current_temp = states(''sensor.study_esp32_henrysroom_temperature'')
      | float(none) %} {% set comfort_low = states(''input_number.henrys_room_temp_comfort_low'')
      | float(21) %} {% set hot = states(''input_number.henrys_room_temp_hot'') |
      float(24) %} {{ current_temp is not none and (current_temp < comfort_low or
      current_temp > hot) }}'
    alias: Temperature outside comfort range
  actions:
  - choose:
    - conditions:
      - condition: template
        value_template: '{% set current_temp = states(''sensor.study_esp32_henrysroom_temperature'')
          | float(none) %} {% set comfort_low = states(''input_number.henrys_room_temp_comfort_low'')
          | float(21) %} {{ current_temp is not none and current_temp < comfort_low
          }}'
        alias: Room is cool enough
      sequence:
      - action: climate.set_hvac_mode
        target:
          entity_id: climate.henry_s_room_versatile_thermostat
        data:
          hvac_mode: 'off'
    - conditions:
      - condition: template
        value_template: '{% set current_temp = states(''sensor.study_esp32_henrysroom_temperature'')
          | float(none) %} {% set hot = states(''input_number.henrys_room_temp_hot'')
          | float(24) %} {{ current_temp is not none and current_temp > hot }}'
        alias: Room is too hot
      sequence:
      - action: climate.set_preset_mode
        target:
          entity_id: climate.henry_s_room_versatile_thermostat
        data:
          preset_mode: boost
      - action: climate.set_hvac_mode
        target:
          entity_id: climate.henry_s_room_versatile_thermostat
        data:
          hvac_mode: cool
  mode: single
- id: '1747602506172'
  alias: Otto's Room - Cooling Night Routine
  description: Keeps Otto's room cool overnight when temperatures rise above comfort
    threshold. Summer automation to complement heating night routine. Uses parameterized
    thresholds from input_number helpers.
  triggers:
  - entity_id:
    - sensor.ottos_room_temp_humidity_sensor_temperature
    trigger: state
  conditions:
  - condition: time
    after: '18:00:00'
    before: 06:00:00
    weekday:
    - sun
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: state
    entity_id: input_boolean.climate_manual_control_otto
    state: 'off'
  - condition: state
    entity_id: input_select.climate_season
    state: summer
  - condition: state
    entity_id: input_boolean.hvac_kids_room_should_be_on
    state: 'on'
    alias: Kids Room HVAC Master On
  - condition: template
    value_template: '{% set current_temp = states(''sensor.ottos_room_temp_humidity_sensor_temperature'')
      | float(none) %} {% set comfort_high = states(''input_number.ottos_room_temp_comfort_high'')
      | float(19.5) %} {% set hot = states(''input_number.ottos_room_temp_hot'') |
      float(23) %} {{ current_temp is not none and (current_temp < comfort_high or
      current_temp > hot) }}'
    alias: Temperature outside comfort range
  actions:
  - choose:
    - conditions:
      - condition: template
        value_template: '{% set current_temp = states(''sensor.ottos_room_temp_humidity_sensor_temperature'')
          | float(none) %} {% set comfort_high = states(''input_number.ottos_room_temp_comfort_high'')
          | float(19.5) %} {{ current_temp is not none and current_temp < comfort_high
          }}'
        alias: Room is cool enough
      sequence:
      - action: climate.set_hvac_mode
        target:
          entity_id: climate.otto_s_room
        data:
          hvac_mode: 'off'
    - conditions:
      - condition: template
        value_template: '{% set current_temp = states(''sensor.ottos_room_temp_humidity_sensor_temperature'')
          | float(none) %} {% set hot = states(''input_number.ottos_room_temp_hot'')
          | float(23) %} {{ current_temp is not none and current_temp > hot }}'
        alias: Room is too hot
      sequence:
      - action: climate.set_preset_mode
        target:
          entity_id: climate.otto_s_room
        data:
          preset_mode: eco
      - action: climate.set_hvac_mode
        target:
          entity_id: climate.otto_s_room
        data:
          hvac_mode: cool
  mode: single
